name: Azure-Analyst
description: "AI-powered detection and incident analysis using Azure OpenAI - mimics Charlotte Toolkit with custom LLM endpoint"
logo: ""
vendor: "Security Engineering"
vendor_products: 
  - "Falcon Insight XDR"
  - "Azure OpenAI"
use_case: "Threat analysis and investigation enrichment"
manifest_version: "2023-05-09"

# Files to exclude from bundle
ignored:
  - CITATION.cff
  - CODE_OF_CONDUCT.md
  - LICENSE
  - SECURITY.md
  - SUPPORT.md
  - docs
  - shared
  - node_modules
  - yarn.lock
  - ui/node_modules
  - ui/yarn.lock
  - ui/extensions/azure-analyst/src
  - ui/extensions/azure-analyst/config
  - ui/extensions/azure-analyst/node_modules
  - ui/extensions/azure-analyst/.gitignore
  - ui/extensions/azure-analyst/package.json
  - ui/extensions/azure-analyst/tsconfig.json
  - ui/extensions/azure-analyst/tsconfig.app.json
  - ui/extensions/azure-analyst/*.md
  - ui/extensions/azure-analyst/*.lock

# UI Configuration
ui:
  extensions:
    - name: Azure-Analyst Extension
      description: "Analyzes CrowdStrike detections and incidents with Azure OpenAI"
      path: ui/extensions/azure-analyst/dist
      entrypoint: ui/extensions/azure-analyst/dist/index.html
      sockets:
        - activity.detections.details
        - crowdscore.incidents.details
      content_security_policy:
        connect-src:
          - self
          - "data:"
          - "https://*.openai.azure.com"
          - "https://*.cognitiveservices.azure.com"
        style-src:
          - self
          - "https://fonts.googleapis.com"
          - "unsafe-inline"
        script-src:
          - self
        img-src:
          - self
          - "data:"
          - "https:"
        font-src:
          - self
          - "https://fonts.gstatic.com"
      permissions: []
      is_ui_builder: false

# Authentication scopes required
auth:
  scopes:
    - detects:read
    - alerts:read
    - incidents:read
  permissions: {}
  roles:
    - admin
    - user

# Foundry Functions (Backend)
functions:
  - name: azure_analyzer
    description: "Sends detection/incident data to Azure OpenAI for analysis"
    file_location: backend_function.py
    handler: handler
    runtime: python3.9
    memory_limit_mb: 512
    timeout_seconds: 60
    environment_variables:
      - AZURE_OPENAI_ENDPOINT
      - AZURE_OPENAI_API_KEY
      - AZURE_DEPLOYMENT_NAME
      - AZURE_API_VERSION

# Workflows for SOAR integration (optional)
workflows:
  - name: analyze_detection_workflow
    description: "SOAR workflow action to analyze detections with Azure OpenAI"
    definition: workflows/analyze_detection.yaml

# Collections for storing analysis results
collections:
  - name: detection_analyses
    description: "Storage for detection analysis results"
    definition: collections/detection_analyses.json

# Documentation
app_docs:
  - USERDOCS.md
  - DEPLOYNOTES.md
